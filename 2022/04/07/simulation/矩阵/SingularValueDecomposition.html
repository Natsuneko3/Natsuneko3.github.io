<hr />
<p>title: å¥‡å¼‚å€¼åˆ†è§£<br />
 date: 2023-10-16 12:00<br />
tags:</p>
<ul>
<li>æ¨¡æ‹Ÿ</li>
<li>ç¬”è®°</li>
<li>çŸ©é˜µ<br />
 category: æ¨¡æ‹Ÿç¬”è®°<br />
 count: true</li>
</ul>
<hr />
<h1 id="å¥‡å¼‚å€¼åˆ†è§£"><a class="anchor" href="#å¥‡å¼‚å€¼åˆ†è§£">#</a> å¥‡å¼‚å€¼åˆ†è§£</h1>
<h1 id="ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡"><a class="anchor" href="#ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡">#</a> ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</h1>
<p>ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡çš„å®šä¹‰å¦‚ä¸‹</p>
<p>ğ´ğ‘¥=ğœ†ğ‘¥</p>
<p>å…¶ä¸­ A æ˜¯ä¸€ä¸ªğ‘›Ã—ğ‘›çš„å®å¯¹ç§°çŸ©é˜µï¼Œğ‘¥æ˜¯ä¸€ä¸ªğ‘›ç»´å‘é‡ï¼Œåˆ™æˆ‘ä»¬è¯´ğœ†æ˜¯çŸ©é˜µ A çš„ä¸€ä¸ªç‰¹å¾å€¼ï¼Œè€Œğ‘¥æ˜¯çŸ©é˜µ A çš„ç‰¹å¾å€¼ğœ†æ‰€å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚</p>
<h1 id="svdå®šä¹‰"><a class="anchor" href="#svdå®šä¹‰">#</a> SVD å®šä¹‰</h1>
<p>D ä¹Ÿæ˜¯å¯¹çŸ©é˜µè¿›è¡Œåˆ†è§£ï¼Œä½†æ˜¯å’Œç‰¹å¾åˆ†è§£ä¸åŒï¼ŒSVD å¹¶ä¸è¦æ±‚è¦åˆ†è§£çš„çŸ©é˜µä¸ºæ–¹é˜µã€‚å‡è®¾æˆ‘ä»¬çš„çŸ©é˜µ A æ˜¯ä¸€ä¸ªğ‘šÃ—ğ‘›çš„çŸ©é˜µï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰çŸ©é˜µ A çš„ SVD ä¸ºï¼š</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>A</mi><mo>=</mo><mi>U</mi><mi mathvariant="normal">Î£</mi><msup><mi>V</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">A = U\Sigma V^T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8913309999999999em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord">Î£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ U æ˜¯ä¸€ä¸ªğ‘šÃ—ğ‘šçš„çŸ©é˜µï¼ŒÎ£ æ˜¯ä¸€ä¸ªğ‘šÃ—ğ‘›çš„çŸ©é˜µï¼Œé™¤äº†ä¸»å¯¹è§’çº¿ä¸Šçš„å…ƒç´ ä»¥å¤–å…¨ä¸º 0ï¼Œä¸»å¯¹è§’çº¿ä¸Šçš„æ¯ä¸ªå…ƒç´ éƒ½ç§°ä¸ºå¥‡å¼‚å€¼ï¼ŒV æ˜¯ä¸€ä¸ªğ‘›Ã—ğ‘›çš„çŸ©é˜µã€‚U å’Œ V éƒ½æ˜¯é…‰çŸ©é˜µï¼Œå³æ»¡è¶³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>U</mi><mi>T</mi></msup><mi>U</mi><mo>=</mo><mi>I</mi><mo separator="true">,</mo><msup><mi>V</mi><mi>T</mi></msup><mi>V</mi><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">U^TU = I,V^TV = I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.035771em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></p>
<p><img src="Untitled.png" alt="Untitled" /></p>
<p>å¦‚æœæˆ‘ä»¬å°† A çš„è½¬ç½®å’Œ A åšçŸ©é˜µä¹˜æ³•ï¼Œé‚£ä¹ˆä¼šå¾—åˆ°ğ‘›Ã—ğ‘›çš„ä¸€ä¸ªæ–¹é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">A^TA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span>ã€‚æ—¢ç„¶<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">A^TA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span> æ˜¯æ–¹é˜µï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç‰¹å¾åˆ†è§£ï¼Œå¾—åˆ°çš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</p>
(ğ´^ğ‘‡ğ´)ğ‘£_ğ‘–=ğœ†_ğ‘–ğ‘£_ğ‘–

<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">A^TA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span> çš„ n ä¸ªç‰¹å¾å€¼å’Œå¯¹åº”çš„ n ä¸ªç‰¹å¾å‘é‡ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> äº†ã€‚å°†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mi>T</mi></msup><mi>A</mi></mrow><annotation encoding="application/x-tex">A^TA</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal">A</span></span></span></span> çš„æ‰€æœ‰ç‰¹å¾å‘é‡å¼ æˆä¸€ä¸ª<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">Ã—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> çš„çŸ©é˜µ Vï¼Œé‚£ä¹ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msup><mi>A</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">AA^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> å°±æ˜¯çš„æ‰€æœ‰ç‰¹å¾å‘é‡å°±æ˜¯çŸ©é˜µ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>ï¼Œ</p>
<p><img src="Untitled%201.png" alt="Untitled" /></p>
<p>ä¹Ÿå°±è¯´ sig çŸ©é˜µå¯ä»¥ç”¨ğ´ğ‘£_ğ‘–=ğœ_ğ‘–u_i ğœ_ğ‘–å°±æ˜¯å¥‡å¼‚å€¼</p>
<p><img src="Untitled%202.png" alt="Untitled" /></p>
<p>å…¶ä¸­ SVD çš„ç‰©ç†å«ä¹‰å°±æ˜¯</p>
<p><img src="Untitled%203.png" alt="Untitled" /></p>
<p>è¿™å°±è¡¨æ˜ä»»æ„çš„çŸ©é˜µ A æ˜¯å¯ä»¥åˆ†è§£æˆä¸‰ä¸ªçŸ©é˜µç›¸ä¹˜çš„å½¢å¼ã€‚<strong>V</strong> è¡¨ç¤ºäº†åŸå§‹åŸŸçš„æ ‡å‡†æ­£äº¤åŸºï¼Œ<strong>U</strong> è¡¨ç¤ºç»è¿‡ A å˜æ¢åçš„ co-domain çš„æ ‡å‡†æ­£äº¤åŸºï¼ŒÎ£ è¡¨ç¤ºäº†<strong> V</strong>Â ä¸­çš„å‘é‡ä¸<strong> U</strong> ä¸­ç›¸å¯¹åº”å‘é‡ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸Šå›¾å‘ç°ï¼Œçº¿æ€§å˜æ¢ A å¯ä»¥åˆ†è§£ä¸º<strong>æ—‹è½¬</strong>ã€<strong>ç¼©æ”¾</strong>ã€<strong>æ—‹è½¬</strong>è¿™ä¸‰ç§åŸºæœ¬çº¿æ€§å˜æ¢ã€‚</p>
<p>sig æ˜¯å¯¹è§’é˜µï¼Œè¡¨ç¤ºå¥‡å¼‚å€¼ï¼ŒA çŸ©é˜µçš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªå‘é‡åœ¨ V è¿™ç»„æ­£äº¤åŸºå‘é‡çš„ç©ºé—´<strong>æ—‹è½¬ï¼Œ<strong>å¹¶å¯¹æ¯ä¸ªæ–¹å‘è¿›è¡Œäº†ä¸€å®šçš„</strong>ç¼©æ”¾</strong>ï¼Œç¼©æ”¾å› å­å°±æ˜¯å„ä¸ªå¥‡å¼‚å€¼ã€‚ç„¶ååœ¨ U è¿™ç»„æ­£äº¤åŸºå‘é‡çš„ç©ºé—´å†æ¬¡<strong>æ—‹è½¬</strong>ã€‚å¯ä»¥è¯´å¥‡å¼‚å€¼åˆ†è§£å°†ä¸€ä¸ªçŸ©é˜µåŸæœ¬æ··åˆåœ¨ä¸€èµ·çš„ä¸‰ç§ä½œç”¨æ•ˆæœï¼Œåˆ†è§£å‡ºæ¥äº†ã€‚</p>
<h1 id="svdåº”ç”¨"><a class="anchor" href="#svdåº”ç”¨">#</a> SVD åº”ç”¨</h1>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»åˆ†è§£çš„è§’åº¦é‡æ–°ç†è§£å‰é¢çš„è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬æŠŠåŸæ¥çš„çŸ©é˜µ<em> A</em> è¡¨è¾¾æˆäº†<em> n</em> ä¸ªçŸ©é˜µçš„å’Œï¼š</p>
<p><img src="Untitled%204.png" alt="Untitled" /></p>
<p>å…¶ä¸­å¥‡å¼‚å€¼å°±æ˜¯æ¯ä¸ªçŸ©é˜µçš„æƒé‡ï¼Œè¶Šå¾€å‰çš„æ¯”ä¾‹è¶Šå¤§ã€‚</p>
<p>æˆ‘ä»¬ç”¨ä¸€ä¸ªå›¾åƒå‹ç¼©çš„ä¾‹å­æ¥è¯´æ˜ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç”µè„‘ä¸Šçš„å›¾åƒï¼ˆç‰¹æŒ‡ä½å›¾ï¼‰éƒ½æ˜¯ç”±åƒç´ ç‚¹ç»„æˆçš„ï¼Œæ‰€ä»¥å­˜å‚¨ä¸€å¼  1000Ã—622 å¤§å°çš„å›¾ç‰‡ï¼Œå®é™…ä¸Šå°±æ˜¯å­˜å‚¨ä¸€ä¸ª 1000Ã—622 çš„çŸ©é˜µï¼Œå…± 622000 ä¸ªå…ƒç´ ã€‚è¿™ä¸ªçŸ©é˜µç”¨ SVD å¯ä»¥åˆ†è§£ä¸º 622 ä¸ªçŸ©é˜µä¹‹å’Œï¼Œå¦‚æœæˆ‘ä»¬é€‰å–å…¶ä¸­çš„å‰ 100 ä¸ªä¹‹å’Œä½œä¸ºå¯¹å›¾åƒæ•°æ®çš„è¿‘ä¼¼ï¼Œé‚£ä¹ˆåªéœ€è¦å­˜å‚¨ 100 ä¸ªå¥‡å¼‚å€¼ï¼Œ100 ä¸ªå‘é‡å’Œ 100 ä¸ªå‘é‡ï¼Œå…±è®¡ 100Ã—(1+1000+622)=162300 ä¸ªå…ƒç´ ï¼Œå¤§çº¦åªæœ‰åŸå§‹çš„ 26% å¤§å°ã€‚</p>
<h1 id="è§£svd"><a class="anchor" href="#è§£svd">#</a> è§£ SVD</h1>
<p>å…¶ä¸­è§£ SVD æœ‰å‡ ç§åŠæ³•</p>
<figure class="highlight glsl"><figcaption data-lang="GLSL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">struct</span> <span class="token class-name">Functions</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token comment">// -----------------------------</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	</pre></td></tr><tr><td data-num="5"></td><td><pre>		</pre></td></tr><tr><td data-num="6"></td><td><pre>	float3 <span class="token function">randomUnitVector</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>		float3 unnormalized<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>			unnormalized<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">RandBBSfloat</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>			</pre></td></tr><tr><td data-num="15"></td><td><pre>		<span class="token keyword">return</span> unnormalized<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>	float3 <span class="token function">svd_1d</span><span class="token punctuation">(</span>float3x3 A<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>		<span class="token keyword">float</span> epsilon <span class="token operator">=</span> <span class="token number">1e-10</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>		float3 x <span class="token operator">=</span> <span class="token function">randomUnitVector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>		float3 lastV <span class="token operator">=</span> <span class="token function">float3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>		float3 currentV <span class="token operator">=</span> x<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>			</pre></td></tr><tr><td data-num="27"></td><td><pre>		float3x3 B <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> <span class="token function">transpose</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>			</pre></td></tr><tr><td data-num="29"></td><td><pre>		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">9</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>			lastV <span class="token operator">=</span> currentV<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>			currentV <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> lastV<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>			currentV <span class="token operator">=</span> <span class="token function">normalize</span><span class="token punctuation">(</span>currentV<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">dot</span><span class="token punctuation">(</span>currentV<span class="token punctuation">,</span> lastV<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">-</span> epsilon<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>			<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>				<span class="token comment">// converged</span></pre></td></tr><tr><td data-num="38"></td><td><pre>				<span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>		<span class="token keyword">return</span> currentV<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>		</pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>	<span class="token keyword">void</span> <span class="token function">svd</span><span class="token punctuation">(</span>float3x3 A<span class="token punctuation">,</span> <span class="token keyword">out</span> float3x3 us<span class="token punctuation">,</span><span class="token keyword">out</span> float3 singularValues<span class="token punctuation">,</span>  <span class="token keyword">out</span> float3x3 vs <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>		</pre></td></tr><tr><td data-num="48"></td><td><pre>	</pre></td></tr><tr><td data-num="49"></td><td><pre>		float3 u<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>		float3 v<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>	    </pre></td></tr><tr><td data-num="52"></td><td><pre>		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>		<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>			float3x3 matrixFor1D <span class="token operator">=</span> A<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre>			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>			<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>					</pre></td></tr><tr><td data-num="59"></td><td><pre>				u <span class="token operator">=</span> us<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>				v <span class="token operator">=</span> vs<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>				float3x3 OuterProduct <span class="token operator">=</span> <span class="token function">float3x3</span><span class="token punctuation">(</span>u<span class="token punctuation">.</span>x <span class="token operator">*</span> v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> u<span class="token punctuation">.</span>x <span class="token operator">*</span> v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> u<span class="token punctuation">.</span>x <span class="token operator">*</span> v<span class="token punctuation">.</span>z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="62"></td><td><pre>					u<span class="token punctuation">.</span>y <span class="token operator">*</span> v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> u<span class="token punctuation">.</span>y <span class="token operator">*</span> v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> u<span class="token punctuation">.</span>y <span class="token operator">*</span> v<span class="token punctuation">.</span>z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="63"></td><td><pre>					u<span class="token punctuation">.</span>z <span class="token operator">*</span> v<span class="token punctuation">.</span>x<span class="token punctuation">,</span> u<span class="token punctuation">.</span>z <span class="token operator">*</span> v<span class="token punctuation">.</span>y<span class="token punctuation">,</span> u<span class="token punctuation">.</span>z <span class="token operator">*</span> v<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>					</pre></td></tr><tr><td data-num="65"></td><td><pre>				matrixFor1D <span class="token operator">-=</span> singularValues<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> OuterProduct<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>			<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre>			float3 u <span class="token operator">=</span> <span class="token function">svd_1d</span><span class="token punctuation">(</span>matrixFor1D<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>			float3 v_unnormalized <span class="token operator">=</span> <span class="token function">mul</span><span class="token punctuation">(</span><span class="token function">transpose</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">,</span> u<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>			<span class="token keyword">float</span> sigma <span class="token operator">=</span> <span class="token function">length</span><span class="token punctuation">(</span>v_unnormalized<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>			float3 v <span class="token operator">=</span> v_unnormalized <span class="token operator">/</span> sigma<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>				</pre></td></tr><tr><td data-num="73"></td><td><pre></pre></td></tr><tr><td data-num="74"></td><td><pre>			singularValues<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sigma<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>			us<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> u<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>			vs<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> v<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>		<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>	<span class="token keyword">void</span> <span class="token function">ConverMatrix</span><span class="token punctuation">(</span>float3x3 Inmat<span class="token punctuation">,</span> <span class="token keyword">out</span> float4x4 OutMat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>		OutMat <span class="token operator">=</span>  <span class="token function">float4x4</span><span class="token punctuation">(</span>Inmat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="82"></td><td><pre>			Inmat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="83"></td><td><pre>			Inmat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="84"></td><td><pre>			<span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>		</pre></td></tr><tr><td data-num="86"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>	<span class="token keyword">void</span> <span class="token function">ConverMatrix</span><span class="token punctuation">(</span>float4x4 Inmat<span class="token punctuation">,</span><span class="token keyword">out</span> float3x3 OutMat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre>	<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>		OutMat <span class="token operator">=</span>  <span class="token function">float3x3</span><span class="token punctuation">(</span>Inmat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="90"></td><td><pre>			Inmat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="91"></td><td><pre>			Inmat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">,</span>Inmat<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>	<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>	</pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> norm</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> normalvariate</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> math <span class="token keyword">import</span> sqrt</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">def</span> <span class="token function">randomUnitVector</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    unnormalized <span class="token operator">=</span> <span class="token punctuation">[</span>normalvariate<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    theNorm <span class="token operator">=</span> sqrt<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token keyword">for</span> x <span class="token keyword">in</span> unnormalized<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">[</span>x <span class="token operator">/</span> theNorm <span class="token keyword">for</span> x <span class="token keyword">in</span> unnormalized<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">def</span> <span class="token function">svd_1d</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">1e-10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token triple-quoted-string string">''' The one-dimensional SVD '''</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    n<span class="token punctuation">,</span> m <span class="token operator">=</span> A<span class="token punctuation">.</span>shape</pre></td></tr><tr><td data-num="17"></td><td><pre>    x <span class="token operator">=</span> randomUnitVector<span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    lastV <span class="token operator">=</span> <span class="token boolean">None</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    currentV <span class="token operator">=</span> x</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">if</span> n <span class="token operator">></span> m<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        B <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>A<span class="token punctuation">.</span>T<span class="token punctuation">,</span> A<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        B <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>A<span class="token punctuation">,</span> A<span class="token punctuation">.</span>T<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    iterations <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        iterations <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        lastV <span class="token operator">=</span> currentV</pre></td></tr><tr><td data-num="30"></td><td><pre>        currentV <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>B<span class="token punctuation">,</span> lastV<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        currentV <span class="token operator">=</span> currentV <span class="token operator">/</span> norm<span class="token punctuation">(</span>currentV<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>currentV<span class="token punctuation">,</span> lastV<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token operator">-</span> epsilon<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"converged in &#123;&#125; iterations!"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>iterations<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>            <span class="token keyword">return</span> currentV</pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">def</span> <span class="token function">svd</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> epsilon<span class="token operator">=</span><span class="token number">1e-10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token triple-quoted-string string">'''</pre></td></tr><tr><td data-num="39"></td><td><pre>        Compute the singular value decomposition of a matrix A</pre></td></tr><tr><td data-num="40"></td><td><pre>        using the power method. A is the input matrix, and k</pre></td></tr><tr><td data-num="41"></td><td><pre>        is the number of singular values you wish to compute.</pre></td></tr><tr><td data-num="42"></td><td><pre>        If k is None, this computes the full-rank decomposition.</pre></td></tr><tr><td data-num="43"></td><td><pre>    '''</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    A <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>A<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    n<span class="token punctuation">,</span> m <span class="token operator">=</span> A<span class="token punctuation">.</span>shape</pre></td></tr><tr><td data-num="46"></td><td><pre>    svdSoFar <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">if</span> k <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        k <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        matrixFor1D <span class="token operator">=</span> A<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token keyword">for</span> singularValue<span class="token punctuation">,</span> u<span class="token punctuation">,</span> v <span class="token keyword">in</span> svdSoFar<span class="token punctuation">[</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre>            matrixFor1D <span class="token operator">-=</span> singularValue <span class="token operator">*</span> np<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token keyword">if</span> n <span class="token operator">></span> m<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="58"></td><td><pre>            v <span class="token operator">=</span> svd_1d<span class="token punctuation">(</span>matrixFor1D<span class="token punctuation">,</span> epsilon<span class="token operator">=</span>epsilon<span class="token punctuation">)</span>  <span class="token comment"># next singular vector</span></pre></td></tr><tr><td data-num="59"></td><td><pre>            u_unnormalized <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>A<span class="token punctuation">,</span> v<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>            sigma <span class="token operator">=</span> norm<span class="token punctuation">(</span>u_unnormalized<span class="token punctuation">)</span>  <span class="token comment"># next singular value</span></pre></td></tr><tr><td data-num="61"></td><td><pre>            u <span class="token operator">=</span> u_unnormalized <span class="token operator">/</span> sigma</pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="63"></td><td><pre>            u <span class="token operator">=</span> svd_1d<span class="token punctuation">(</span>matrixFor1D<span class="token punctuation">,</span> epsilon<span class="token operator">=</span>epsilon<span class="token punctuation">)</span>  <span class="token comment"># next singular vector</span></pre></td></tr><tr><td data-num="64"></td><td><pre>            v_unnormalized <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>A<span class="token punctuation">.</span>T<span class="token punctuation">,</span> u<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre>            sigma <span class="token operator">=</span> norm<span class="token punctuation">(</span>v_unnormalized<span class="token punctuation">)</span>  <span class="token comment"># next singular value</span></pre></td></tr><tr><td data-num="66"></td><td><pre>            v <span class="token operator">=</span> v_unnormalized <span class="token operator">/</span> sigma</pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre>        svdSoFar<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>sigma<span class="token punctuation">,</span> u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre>    singularValues<span class="token punctuation">,</span> us<span class="token punctuation">,</span> vs <span class="token operator">=</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>svdSoFar<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token keyword">return</span> singularValues<span class="token punctuation">,</span> us<span class="token punctuation">.</span>T<span class="token punctuation">,</span> vs</pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token keyword">def</span> <span class="token function">QR_HouseHolder</span><span class="token punctuation">(</span>mat<span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    cols <span class="token operator">=</span> mat<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre>    Q <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>cols<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    R <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>cols <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        a <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>R<span class="token punctuation">[</span>col<span class="token punctuation">:</span><span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre>        e <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>cols <span class="token operator">-</span> col<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.0</span></pre></td></tr><tr><td data-num="83"></td><td><pre>        num <span class="token operator">=</span> R<span class="token punctuation">[</span>col<span class="token punctuation">:</span><span class="token punctuation">,</span> col<span class="token punctuation">]</span> <span class="token operator">-</span> a <span class="token operator">*</span> e</pre></td></tr><tr><td data-num="84"></td><td><pre>        den <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="85"></td><td><pre></pre></td></tr><tr><td data-num="86"></td><td><pre>        u <span class="token operator">=</span> num <span class="token operator">/</span> den</pre></td></tr><tr><td data-num="87"></td><td><pre>        H <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>cols<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        H<span class="token punctuation">[</span>col<span class="token punctuation">:</span><span class="token punctuation">,</span> col<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token punctuation">(</span>cols <span class="token operator">-</span> col<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> u<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>u<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="89"></td><td><pre>        R <span class="token operator">=</span> H<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>R<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre></pre></td></tr><tr><td data-num="91"></td><td><pre>        Q <span class="token operator">=</span> Q<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>H<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="92"></td><td><pre></pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token keyword">return</span> Q<span class="token punctuation">,</span> R</pre></td></tr><tr><td data-num="94"></td><td><pre></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token keyword">def</span> <span class="token function">QR_GivenRot</span><span class="token punctuation">(</span>mat<span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    rows<span class="token punctuation">,</span> cols <span class="token operator">=</span> mat<span class="token punctuation">.</span>shape</pre></td></tr><tr><td data-num="97"></td><td><pre></pre></td></tr><tr><td data-num="98"></td><td><pre>    R <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="99"></td><td><pre>    Q <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>cols<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre></pre></td></tr><tr><td data-num="101"></td><td><pre>    <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>cols<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="102"></td><td><pre>        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>col <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="103"></td><td><pre>            <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>R<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1e-6</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="104"></td><td><pre>                <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="105"></td><td><pre></pre></td></tr><tr><td data-num="106"></td><td><pre>            f <span class="token operator">=</span> R<span class="token punctuation">[</span>col<span class="token punctuation">,</span> col<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="107"></td><td><pre>            s <span class="token operator">=</span> R<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="108"></td><td><pre>            den <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>f <span class="token operator">*</span> f <span class="token operator">+</span> s <span class="token operator">*</span> s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="109"></td><td><pre>            c <span class="token operator">=</span> f <span class="token operator">/</span> den</pre></td></tr><tr><td data-num="110"></td><td><pre>            s <span class="token operator">=</span> s <span class="token operator">/</span> den</pre></td></tr><tr><td data-num="111"></td><td><pre></pre></td></tr><tr><td data-num="112"></td><td><pre>            T <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>rows<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="113"></td><td><pre>            T<span class="token punctuation">[</span>col<span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">,</span> T<span class="token punctuation">[</span>row<span class="token punctuation">,</span> row<span class="token punctuation">]</span> <span class="token operator">=</span> c<span class="token punctuation">,</span> c</pre></td></tr><tr><td data-num="114"></td><td><pre>            T<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">,</span> T<span class="token punctuation">[</span>col<span class="token punctuation">,</span> row<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>s<span class="token punctuation">,</span> s</pre></td></tr><tr><td data-num="115"></td><td><pre></pre></td></tr><tr><td data-num="116"></td><td><pre>            R <span class="token operator">=</span> T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>R<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="117"></td><td><pre></pre></td></tr><tr><td data-num="118"></td><td><pre>            Q <span class="token operator">=</span> T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="119"></td><td><pre></pre></td></tr><tr><td data-num="120"></td><td><pre>    <span class="token keyword">return</span> Q<span class="token punctuation">.</span>T<span class="token punctuation">,</span> R</pre></td></tr><tr><td data-num="121"></td><td><pre></pre></td></tr><tr><td data-num="122"></td><td><pre><span class="token comment"># ---------------------------------------</span></pre></td></tr><tr><td data-num="123"></td><td><pre><span class="token keyword">def</span> <span class="token function">QR_Basic</span><span class="token punctuation">(</span>mat<span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="124"></td><td><pre>    eig <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="125"></td><td><pre></pre></td></tr><tr><td data-num="126"></td><td><pre>    rows<span class="token punctuation">,</span> cols <span class="token operator">=</span> mat<span class="token punctuation">.</span>shape</pre></td></tr><tr><td data-num="127"></td><td><pre>    eigV <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>cols<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="129"></td><td><pre>        q<span class="token punctuation">,</span> r <span class="token operator">=</span> QR_HouseHolder<span class="token punctuation">(</span>eig<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="130"></td><td><pre>        eig <span class="token operator">=</span> r<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="131"></td><td><pre>        eigV <span class="token operator">=</span> eigV<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>eig<span class="token punctuation">)</span><span class="token punctuation">,</span> eigV</pre></td></tr><tr><td data-num="134"></td><td><pre></pre></td></tr><tr><td data-num="135"></td><td><pre><span class="token comment"># ---------------------------------------</span></pre></td></tr><tr><td data-num="136"></td><td><pre><span class="token keyword">def</span> <span class="token function">QR_Heisenberg</span><span class="token punctuation">(</span>mat<span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="137"></td><td><pre>    rows<span class="token punctuation">,</span> cols <span class="token operator">=</span> mat<span class="token punctuation">.</span>shape</pre></td></tr><tr><td data-num="138"></td><td><pre>    Hsbg <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="139"></td><td><pre></pre></td></tr><tr><td data-num="140"></td><td><pre>    eigv <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>cols<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="142"></td><td><pre>        array <span class="token operator">=</span> mat<span class="token punctuation">[</span>row<span class="token punctuation">:</span><span class="token punctuation">,</span> row <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="143"></td><td><pre></pre></td></tr><tr><td data-num="144"></td><td><pre>        <span class="token comment"># householder</span></pre></td></tr><tr><td data-num="145"></td><td><pre>        a <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>array<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="146"></td><td><pre></pre></td></tr><tr><td data-num="147"></td><td><pre>        e <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rows <span class="token operator">-</span> row<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="148"></td><td><pre>        e<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.0</span></pre></td></tr><tr><td data-num="149"></td><td><pre>        num <span class="token operator">=</span> array <span class="token operator">-</span> a <span class="token operator">*</span> e</pre></td></tr><tr><td data-num="150"></td><td><pre>        u <span class="token operator">=</span> num <span class="token operator">/</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>num<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="151"></td><td><pre></pre></td></tr><tr><td data-num="152"></td><td><pre>        H <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>rows <span class="token operator">-</span> row<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> u<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>u<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="153"></td><td><pre></pre></td></tr><tr><td data-num="154"></td><td><pre>        <span class="token comment"># Hsbg</span></pre></td></tr><tr><td data-num="155"></td><td><pre>        T <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>rows<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        T<span class="token punctuation">[</span>row<span class="token punctuation">:</span><span class="token punctuation">,</span> row<span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> H</pre></td></tr><tr><td data-num="157"></td><td><pre></pre></td></tr><tr><td data-num="158"></td><td><pre>        Hsbg <span class="token operator">=</span> T<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Hsbg<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>T<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="159"></td><td><pre>        eigv <span class="token operator">=</span> eigv<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>T<span class="token punctuation">.</span>T<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="160"></td><td><pre></pre></td></tr><tr><td data-num="161"></td><td><pre>    eigv <span class="token operator">=</span> eigv<span class="token punctuation">.</span>T</pre></td></tr><tr><td data-num="162"></td><td><pre>    <span class="token comment"># Given</span></pre></td></tr><tr><td data-num="163"></td><td><pre>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="164"></td><td><pre>        q<span class="token punctuation">,</span> r <span class="token operator">=</span> QR_GivenRot<span class="token punctuation">(</span>Hsbg<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="165"></td><td><pre>        Hsbg <span class="token operator">=</span> r<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="166"></td><td><pre>        eigv <span class="token operator">=</span> eigv<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="167"></td><td><pre>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>Hsbg<span class="token punctuation">)</span><span class="token punctuation">,</span> eigv</pre></td></tr><tr><td data-num="168"></td><td><pre></pre></td></tr><tr><td data-num="169"></td><td><pre><span class="token comment"># -----------------------------</span></pre></td></tr><tr><td data-num="170"></td><td><pre><span class="token keyword">def</span> <span class="token function">Jacobi_Basic</span><span class="token punctuation">(</span>mat<span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="171"></td><td><pre>    rows<span class="token punctuation">,</span> cols <span class="token operator">=</span> mat<span class="token punctuation">.</span>shape</pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre>    eig <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="174"></td><td><pre>    eigV <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>rows<span class="token punctuation">,</span> cols<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="175"></td><td><pre></pre></td></tr><tr><td data-num="176"></td><td><pre>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="177"></td><td><pre>        maxRow<span class="token punctuation">,</span> maxCol <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="178"></td><td><pre>        maxValue <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="180"></td><td><pre>            <span class="token keyword">for</span> col <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>cols<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="181"></td><td><pre>                <span class="token keyword">if</span> row <span class="token operator">==</span> col<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="182"></td><td><pre>                    <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="183"></td><td><pre>                <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>eig<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> maxValue<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="184"></td><td><pre>                    maxValue <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>eig<span class="token punctuation">[</span>row<span class="token punctuation">,</span> col<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="185"></td><td><pre>                    maxRow <span class="token operator">=</span> row</pre></td></tr><tr><td data-num="186"></td><td><pre>                    maxCol <span class="token operator">=</span> col</pre></td></tr><tr><td data-num="187"></td><td><pre>        a <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="188"></td><td><pre>        <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>eig<span class="token punctuation">[</span>maxRow<span class="token punctuation">,</span> maxRow<span class="token punctuation">]</span> <span class="token operator">-</span> eig<span class="token punctuation">[</span>maxCol<span class="token punctuation">,</span> maxCol<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1e-5</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="189"></td><td><pre>            a <span class="token operator">=</span> <span class="token number">0.25</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi</pre></td></tr><tr><td data-num="190"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="191"></td><td><pre>            a <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>arctan<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> eig<span class="token punctuation">[</span>maxRow<span class="token punctuation">,</span> maxCol<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>eig<span class="token punctuation">[</span>maxRow<span class="token punctuation">,</span> maxRow<span class="token punctuation">]</span> <span class="token operator">-</span> eig<span class="token punctuation">[</span>maxCol<span class="token punctuation">,</span> maxCol<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="192"></td><td><pre></pre></td></tr><tr><td data-num="193"></td><td><pre>        P <span class="token operator">=</span> np<span class="token punctuation">.</span>eye<span class="token punctuation">(</span>rows<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="194"></td><td><pre>        P<span class="token punctuation">[</span>maxRow<span class="token punctuation">,</span> maxRow<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="195"></td><td><pre>        P<span class="token punctuation">[</span>maxCol<span class="token punctuation">,</span> maxCol<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="196"></td><td><pre>        P<span class="token punctuation">[</span>maxRow<span class="token punctuation">,</span> maxCol<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="197"></td><td><pre>        P<span class="token punctuation">[</span>maxCol<span class="token punctuation">,</span> maxRow<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="198"></td><td><pre>        eig <span class="token operator">=</span> P<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>eig<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>P<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="199"></td><td><pre>        eigV <span class="token operator">=</span> eigV<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>P<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="200"></td><td><pre></pre></td></tr><tr><td data-num="201"></td><td><pre>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>eig<span class="token punctuation">)</span><span class="token punctuation">,</span> eigV</pre></td></tr><tr><td data-num="202"></td><td><pre></pre></td></tr><tr><td data-num="203"></td><td><pre><span class="token comment"># ----------------</span></pre></td></tr><tr><td data-num="204"></td><td><pre><span class="token keyword">def</span> <span class="token function">SortEig</span><span class="token punctuation">(</span>eig<span class="token punctuation">,</span> eigV<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="205"></td><td><pre>    e <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>eig<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="206"></td><td><pre>    v <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>eigV<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="207"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="208"></td><td><pre>    indices <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="209"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>indices<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="210"></td><td><pre>    e <span class="token operator">=</span> np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="211"></td><td><pre></pre></td></tr><tr><td data-num="212"></td><td><pre>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>indices<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="213"></td><td><pre>        v<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> eigV<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="214"></td><td><pre></pre></td></tr><tr><td data-num="215"></td><td><pre>    <span class="token keyword">return</span> e<span class="token punctuation">,</span> v</pre></td></tr><tr><td data-num="216"></td><td><pre></pre></td></tr><tr><td data-num="217"></td><td><pre><span class="token keyword">def</span> <span class="token function">SVD_Solver</span><span class="token punctuation">(</span>mat<span class="token punctuation">,</span> Func<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="218"></td><td><pre>    aTa <span class="token operator">=</span> mat<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="219"></td><td><pre>    aaT <span class="token operator">=</span> mat<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="220"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Ata:</span><span class="token interpolation"><span class="token punctuation">&#123;</span> aTa<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="221"></td><td><pre>    eig<span class="token punctuation">,</span> eigv <span class="token operator">=</span> Func<span class="token punctuation">(</span>aTa<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="222"></td><td><pre></pre></td></tr><tr><td data-num="223"></td><td><pre>    eig<span class="token punctuation">,</span> eigv <span class="token operator">=</span> SortEig<span class="token punctuation">(</span>eig<span class="token punctuation">,</span> eigv<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="224"></td><td><pre></pre></td></tr><tr><td data-num="225"></td><td><pre>    rows<span class="token punctuation">,</span> cols <span class="token operator">=</span> mat<span class="token punctuation">.</span>shape</pre></td></tr><tr><td data-num="226"></td><td><pre>    U <span class="token operator">=</span> eigv</pre></td></tr><tr><td data-num="227"></td><td><pre>    S <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="228"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="229"></td><td><pre>        S<span class="token punctuation">[</span>i<span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> eig<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="230"></td><td><pre></pre></td></tr><tr><td data-num="231"></td><td><pre>    eig<span class="token punctuation">,</span> eigv <span class="token operator">=</span> Func<span class="token punctuation">(</span>aaT<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="232"></td><td><pre>    eig<span class="token punctuation">,</span> eigv <span class="token operator">=</span> SortEig<span class="token punctuation">(</span>eig<span class="token punctuation">,</span> eigv<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="233"></td><td><pre>    V <span class="token operator">=</span> eigv</pre></td></tr><tr><td data-num="234"></td><td><pre></pre></td></tr><tr><td data-num="235"></td><td><pre>    <span class="token keyword">return</span> U<span class="token punctuation">,</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">,</span> V</pre></td></tr><tr><td data-num="236"></td><td><pre></pre></td></tr><tr><td data-num="237"></td><td><pre><span class="token keyword">def</span> <span class="token function">SVD1</span><span class="token punctuation">(</span>mat<span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">,</span> Method<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="238"></td><td><pre>    <span class="token comment"># Method: 0: QR_Basic, 1:QR_Heisenberg, 2:Jacobi_Basic</span></pre></td></tr><tr><td data-num="239"></td><td><pre>    U<span class="token punctuation">,</span> S<span class="token punctuation">,</span> V <span class="token operator">=</span> SVD_Solver<span class="token punctuation">(</span>mat<span class="token punctuation">,</span> Jacobi_Basic<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="240"></td><td><pre></pre></td></tr><tr><td data-num="241"></td><td><pre>    <span class="token keyword">return</span> U<span class="token punctuation">,</span> S<span class="token punctuation">,</span> V</pre></td></tr><tr><td data-num="242"></td><td><pre></pre></td></tr><tr><td data-num="243"></td><td><pre>mat <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="244"></td><td><pre>                <span class="token punctuation">[</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="245"></td><td><pre>                <span class="token punctuation">[</span><span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="246"></td><td><pre></pre></td></tr><tr><td data-num="247"></td><td><pre>start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="248"></td><td><pre></pre></td></tr><tr><td data-num="249"></td><td><pre>end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="250"></td><td><pre>usetime <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time</pre></td></tr><tr><td data-num="251"></td><td><pre><span class="token comment"># print(f"Method QR_Basic use: &#123;usetime&#125; " )</span></pre></td></tr><tr><td data-num="252"></td><td><pre><span class="token comment"># print(u)</span></pre></td></tr><tr><td data-num="253"></td><td><pre><span class="token comment"># print(s)</span></pre></td></tr><tr><td data-num="254"></td><td><pre><span class="token comment"># print(v)</span></pre></td></tr><tr><td data-num="255"></td><td><pre><span class="token comment"># print("\n")</span></pre></td></tr><tr><td data-num="256"></td><td><pre></pre></td></tr><tr><td data-num="257"></td><td><pre>start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="258"></td><td><pre>u<span class="token punctuation">,</span> s<span class="token punctuation">,</span> v <span class="token operator">=</span> svd<span class="token punctuation">(</span>mat<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="259"></td><td><pre>end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="260"></td><td><pre>usetime <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time</pre></td></tr><tr><td data-num="261"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Method Jacobi_Basic use: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>usetime<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span> <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="262"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="263"></td><td><pre><span class="token comment"># print(s)</span></pre></td></tr><tr><td data-num="264"></td><td><pre><span class="token comment"># print(v)</span></pre></td></tr><tr><td data-num="265"></td><td><pre><span class="token comment"># print("\n")</span></pre></td></tr><tr><td data-num="266"></td><td><pre></pre></td></tr><tr><td data-num="267"></td><td><pre>start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="268"></td><td><pre>u<span class="token punctuation">,</span> s<span class="token punctuation">,</span> v <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>svd<span class="token punctuation">(</span>mat<span class="token punctuation">)</span><span class="token comment">#SVD(mat, 0)</span></pre></td></tr><tr><td data-num="269"></td><td><pre>end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="270"></td><td><pre>usetime <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time</pre></td></tr><tr><td data-num="271"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Method Real use: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>usetime<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="272"></td><td><pre></pre></td></tr><tr><td data-num="273"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="274"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="275"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="276"></td><td><pre><span class="token comment"># print("\n")</span></pre></td></tr></table></figure><p>å…¶ä¸­è¿™æ®µä»£ç æœ€å¿«æ˜¯ jacobi ç®—æ³•</p>
